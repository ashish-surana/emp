<!DOCTYPE HTML>
<html>
    <head>
        <title>Enhanced Meeting Planner</title>
        <style type="text/css">
            #image{
                width:75px;
                height:75px;
            }

            #image:hover{
                width:250px;
                height:250px;
            }
        </style>
    </head>
    <body>
            <strong><a href='http://ayeshamd.com/emp_insert.html'>to insert page</a></strong>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <strong><a href='http://ayeshamd.com'>to main page</a></strong>
        <H1>Enhanced Meeting Planner POC - Search</H1> 
        <hr>

        <fieldset>
            <legend>Enhanced Meeting Planner Elastic Search Server Details</legend>
            EMP Host: <input type="text" id="empHost" value="https://search-emp-cixk22lczi5yrt4zd2dhswnltm.us-east-1.es.amazonaws.com" />
            <br>
            EMP Index: <input type="text" id="empIndex" value="emp" />
            <br>
            EMP Type: <input type="text" id="empType" value="rooms" />
        </fieldset>

        <hr><br>

        <fieldset>
            <legend>Help me search</legend>
            <button onclick="showAllRecords()">Show All Meeting Spaces</button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button onclick="showRecordsByFieldsAndKeywords()">Search By Fields and Keywords</button>
            <input type="text" id="fieldsToSearch" value="field names to search" />
            &nbsp;
            <input type="text" id="keywordsInFields" value="keywords to search" />
        </fieldset>
        
        <br><br>

        <fieldset>
            <legend>I know what I am looking for</legend>
            <button onclick="showRecordsByKeywords()">Search By Attributes</button>
            <input type="text" id="keywords" value="type attributes/tags" />
            <br><br>
            <button onclick="showRecordsByTheme()">Search By Theme</button>
            <input type="text" id="theme" value="type theme" />
            <br><br>
            <button onclick="showRecordsByEmailId()">Search By Email Id</button>
            <input type="text" id="emailId" value="type email" />
        </fieldset>
        <br>

        <div >
            <table align="center">
                <tr id="AmazonS3Images">
                    <!-- place holder for Amazon S3 Images -->
                </tr>
            </table>
        </div>
        
        <div>
            <ul id="spacesSummary">
                <!-- place holder for summary -->
            </ul>
        </div>

 
        <!-- <div>
            <ul>
                <li>
                <img src="http://lorempixum.com/100/100/nature/1" >
                <h3>The Grasslands</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent euismod ultrices ante, ac laoreet nulla vestibulum adipiscing. Nam quis justo in augue auctor imperdiet.</p>
                </li>
            </ul>
        </div>         -->








        <textarea id="allResponses" rows="20" cols="50">Summarized records</textarea>
        <textarea id="responseByEmailId" rows="20" cols="50">Detailed records</textarea>

        <br> <hr> <br>

        <!-- The methods in this script are mostly unaware of the html elements -->
        <script type="text/javascript" src="emp_search_helper.js"></script>

        <!-- The methods in this script are closely tied to the html elements -->
        <script>
            // function showAllRecords() {
            //     var resp = searchAll();
            //     var respTxt = filterSelectedFields(resp);
            //     document.getElementById("allResponses").innerHTML = respTxt;
            //     showImages();
            // }

            function showAllRecords() {
                var resp = searchAll();

                var js = JSON.parse(resp);
                var rooms = js.hits.hits;

                var summary = "";
                for (var i = 0; i < rooms.length; i++) {
                    showImageAndData (
                        rooms[i]._source.meeting_place.theme,
                        rooms[i]._source.meeting_place.name,
                        rooms[i]._source.meeting_place.email,
                        rooms[i]._source.meeting_place.desc
                    )
                }
            }



            function showRecordsByFieldsAndKeywords() {
                var fields = document.getElementById("fieldsToSearch").value;
                var keywords = document.getElementById("keywordsInFields").value;

                var resp = searchBy(fields, keywords);
                var respTxt = filterSelectedFields(resp);
                document.getElementById("allResponses").innerHTML = respTxt;
            }

            function showRecordsByKeywords() {
                var keywords = document.getElementById("keywords").value;
                var resp = searchByKeywords(keywords);
                var respTxt = filterSelectedFields(resp);
                document.getElementById("allResponses").innerHTML = respTxt;
            }

            function showRecordsByTheme() {
                var theme = document.getElementById("theme").value;
                var resp = searchByTheme(theme);
                var respTxt = filterSelectedFields(resp);
                document.getElementById("allResponses").innerHTML = respTxt;
            }

            function showRecordsByEmailId() {
                var email = document.getElementById("emailId").value;
                var resp = searchByEmailId(email);
                document.getElementById("responseByEmailId").innerHTML = resp; 
            }

            function filterSelectedFields(response) {
                var js = JSON.parse(response);
                var rooms = js.hits.hits;

                var summary = "";
                for (var i = 0; i < rooms.length; i++) {
                    summary += 
                        rooms[i]._source.meeting_place.email + "\t"
                        + rooms[i]._source.meeting_place.name + "\t"
                        + rooms[i]._source.meeting_place.theme + "\n"
                    ;
                }
                return summary;
            }


            function showImages() {
                var randomImageUrls = "";
                for (i = 1; i < 8; i++) { 
                    randomImageUrls += '<th><img id="image" class="thumbnail" src="https://s3.amazonaws.com/empharv/image'
                                    + Math.floor(Math.random() * 49 + 1) 
                                    + '.jpeg"/></th>';
                }
                document.getElementById("AmazonS3Images").innerHTML = randomImageUrls;
            }


            function showImageAndData(theme, name, email, desc) {
                var randomImageUrls = "";
                randomImageUrl = 'src="https://s3.amazonaws.com/empharv/image'
                                    + Math.floor(Math.random() * 49 + 1) 
                                    + '.jpeg"';
                var entry = '<li>' 
                    + '<img src="' + randomImageUrl + '">'
                    + '<h3>' + name + ' [' + theme + ']</h3>'
                    + '<p>' + desc + '</p>'
                    + '</li>';
                document.getElementById("spacesSummary").innerHTML = randomImageUrls;
            }


        </script>
    </body>
</html>