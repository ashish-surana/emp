<!DOCTYPE HTML>
<html>
    <head>
        <title>Enhanced Meeting Planner</title>
    </head>
    <body>
        <h4><a href='http://ayeshamd.com/emp_insert.html'>to insertion form</a></h4>
        <H1>Enhanced Meeting Planner POC - Search</H1> 
        <hr>
        <fieldset>
            <legend>Enhanced Meeting Planner Elastic Search Server Details</legend>
            EMP Host: <input type="text" id="empHost" value="https://search-emp-cixk22lczi5yrt4zd2dhswnltm.us-east-1.es.amazonaws.com" />
            <br>
            EMP Index: <input type="text" id="empIndex" value="emp" />
            <br>
            EMP Type: <input type="text" id="empType" value="rooms" />
        </fieldset>
        <hr><br>

            <p>
            <button onclick="searchElastic()">Search All</button>
            <br><br>
            <button onclick="searchElasticByEmailId()">Search By Email Id</button>
            <input type="text" id="emailId" value="email" />
            </p>
 
            <br>
            <textarea id="allEsResponses" rows="20" cols="50">All records 
            </textarea>
            <textarea id="esResponseByEmailId" rows="20" cols="50">Record matching emailid
            </textarea>
        <br><hr><br>


        <!-- This script can be moved to emp_core.js -->
        <script>
        var DEV_DEBUG = false;

        function searchElastic(form) {
            if (DEV_DEBUG) alert('HERE 1');
            var jsonStr = null;

            var empUrl = null;
            var empHost = null;
            var empIndex = null;
            var empType = null;

            if (empHost == null || empHost == undefined) 
                empHost = 'https://search-emp-cixk22lczi5yrt4zd2dhswnltm.us-east-1.es.amazonaws.com';
            if (empIndex == null || empIndex == undefined)
                empIndex = "emp";
            if (empType == null || empType == undefined) 
                empType = "rooms";
            
            if (DEV_DEBUG) alert('HERE 2');
            empUrl = empHost + "/" + empIndex + "/" + empType;
            
            if (DEV_DEBUG) alert('HERE 3');
            searchUsingXmlHttp();
            return false;
        }


        function searchUsingXmlHttp() {
            var empUrl = 'https://search-emp-cixk22lczi5yrt4zd2dhswnltm.us-east-1.es.amazonaws.com/emp/rooms/_search';       
            
            var jsonStr = '{"query" : {"match_all" : {}}}';
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open('POST', empUrl, false);
            xmlHttp.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
            xmlHttp.send(jsonStr);
            //var response = JSON.stringify(xmlHttp.responseText);
            var response = JSON.stringify(JSON.parse(xmlHttp.responseText),null,2);  
            if (DEV_DEBUG) alert(response);
            document.getElementById("allEsResponses").innerHTML = response;
        }

        function searchElasticByEmailId() {

            var emailId = document.getElementById("emailId").value;

            var empUrl = 'https://search-emp-cixk22lczi5yrt4zd2dhswnltm.us-east-1.es.amazonaws.com/emp/rooms/_search';       
            

            var jsonStr = '{"query": {"ids" : {"values" : [' +  + ']}}}';

            alert (jsonStr);
            
            
    
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open('POST', empUrl, false);
            xmlHttp.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
            //xmlHttp.send('{"query": {"terms" : {"_id" : [' + "guuos@emp.com" + ']}}}');
            xmlHttp.send(jsonStr);

            //var response = JSON.stringify(xmlHttp.responseText);
            var response = JSON.stringify(JSON.parse(xmlHttp.responseText),null,2);  
            if (DEV_DEBUG) alert(response);
            document.getElementById("esResponseByEmailId").innerHTML = response;
        }

        </script>
    </body>
</html>